
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery_output/FunctionEnrichment/plot_geneset_enrichment.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_output_FunctionEnrichment_plot_geneset_enrichment.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_output_FunctionEnrichment_plot_geneset_enrichment.py:


Identify enriched gene sets associated with differentially spliced PTMs
=======================================================================

As is commonly done for exon-centric analyses, we have provided the ability to perform gene set enrichment analysis for gene associated with spliced PTMs, using the EnrichR API from the gseapy module. By default, we include gene ontology terms, KEGG pathways, and Reactome pathways, but you can also provide your own gene sets listed in EnrichR.

.. GENERATED FROM PYTHON SOURCE LINES 7-19

.. code-block:: Python


    from ptm_pose import helpers
    from ptm_pose.analyze import annotations
    import matplotlib.pyplot as plt
    import warnings
    warnings.filterwarnings("ignore")


    # Load spliced ptm and altered flank data
    spliced_ptms, altered_flanks = helpers.load_example_data(spliced_ptms = True, altered_flanks=True)









.. GENERATED FROM PYTHON SOURCE LINES 20-21

Use the below function, we can identify enriched gene sets associated with spliced ptms, altered flanks, or both. We can also specify the gene sets to assess, alpha value for significance, the minimum change in PSI value to consider, and whether to return only significant gene sets.

.. GENERATED FROM PYTHON SOURCE LINES 21-24

.. code-block:: Python

    genesets = annotations.gene_set_enrichment(spliced_ptms, altered_flanks, alpha = 0.05, min_dPSI = 0.1, gene_sets = ['GO_Biological_Process_2023','Reactome_2022'], return_sig_only = True)
    genesets.head()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    334 PTMs removed due to insignificant splice event (p < 0.05, dpsi >= 0.2): (69.01%)
    Final number of PTMs to be assessed: 150
    77 PTMs removed due to insignificant splice event (p < 0.05, dpsi >= 0.2): (51.33%)
    Final number of PTMs to be assessed: 73


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Gene_set</th>
          <th>Term</th>
          <th>Overlap</th>
          <th>P-value</th>
          <th>Adjusted P-value</th>
          <th>Old P-value</th>
          <th>Old Adjusted P-value</th>
          <th>Odds Ratio</th>
          <th>Combined Score</th>
          <th>Genes</th>
          <th>Type</th>
          <th>Genes with Differentially Included PTMs only</th>
          <th>Genes with PTM with Altered Flanking Sequence only</th>
          <th>Genes with Both</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>GO_Biological_Process_2023</td>
          <td>Axon Development (GO:0061564)</td>
          <td>5/99</td>
          <td>0.000002</td>
          <td>0.001424</td>
          <td>0</td>
          <td>0</td>
          <td>27.803751</td>
          <td>361.881752</td>
          <td>APLP2;DOCK7;BAIAP2;FGFR2;MARK2</td>
          <td>Differentially Included + Altered Flanking Seq...</td>
          <td>FGFR2</td>
          <td>BAIAP2</td>
          <td>APLP2;MARK2;DOCK7</td>
        </tr>
        <tr>
          <th>1</th>
          <td>GO_Biological_Process_2023</td>
          <td>Cell Morphogenesis Involved In Neuron Differen...</td>
          <td>4/77</td>
          <td>0.000022</td>
          <td>0.007049</td>
          <td>0</td>
          <td>0</td>
          <td>27.936776</td>
          <td>299.153677</td>
          <td>APLP2;DOCK7;BAIAP2;FGFR2</td>
          <td>Differentially Included + Altered Flanking Seq...</td>
          <td>FGFR2</td>
          <td>BAIAP2</td>
          <td>APLP2;DOCK7</td>
        </tr>
        <tr>
          <th>2</th>
          <td>GO_Biological_Process_2023</td>
          <td>Integrin-Mediated Signaling Pathway (GO:0007229)</td>
          <td>4/85</td>
          <td>0.000033</td>
          <td>0.007049</td>
          <td>0</td>
          <td>0</td>
          <td>25.167458</td>
          <td>259.671997</td>
          <td>CEACAM1;ADAM15;ITGA6;CD47</td>
          <td>Differentially Included + Altered Flanking Seq...</td>
          <td>CD47;ITGA6;ADAM15</td>
          <td></td>
          <td>CEACAM1</td>
        </tr>
        <tr>
          <th>3</th>
          <td>GO_Biological_Process_2023</td>
          <td>Axonogenesis (GO:0007409)</td>
          <td>5/188</td>
          <td>0.000050</td>
          <td>0.008020</td>
          <td>0</td>
          <td>0</td>
          <td>14.217716</td>
          <td>140.769042</td>
          <td>ENAH;APLP2;DOCK7;BAIAP2;FGFR2</td>
          <td>Differentially Included + Altered Flanking Seq...</td>
          <td>FGFR2</td>
          <td>BAIAP2</td>
          <td>APLP2;DOCK7;ENAH</td>
        </tr>
        <tr>
          <th>4</th>
          <td>GO_Biological_Process_2023</td>
          <td>Regulation Of Cell-Cell Adhesion (GO:0022407)</td>
          <td>3/43</td>
          <td>0.000108</td>
          <td>0.013375</td>
          <td>0</td>
          <td>0</td>
          <td>37.344375</td>
          <td>341.223477</td>
          <td>CEACAM1;CD47;NF2</td>
          <td>Differentially Included + Altered Flanking Seq...</td>
          <td>CD47</td>
          <td>NF2</td>
          <td>CEACAM1</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 25-26

You can then plot the enriched gene sets, including the proportion of genes associated with differentially included PTMs and those with altered flanking sequences. Here, let's restrict to looking at the top 5 enriched gene sets:

.. GENERATED FROM PYTHON SOURCE LINES 26-29

.. code-block:: Python


    annotations.plot_EnrichR_pies(genesets, top_terms = 5)
    plt.tight_layout()
    plt.show()


.. image-sg:: /gallery_output/FunctionEnrichment/images/sphx_glr_plot_geneset_enrichment_001.png
   :alt: plot geneset enrichment
   :srcset: /gallery_output/FunctionEnrichment/images/sphx_glr_plot_geneset_enrichment_001.png
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.680 seconds)


.. _sphx_glr_download_gallery_output_FunctionEnrichment_plot_geneset_enrichment.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_geneset_enrichment.ipynb <plot_geneset_enrichment.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_geneset_enrichment.py <plot_geneset_enrichment.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_geneset_enrichment.zip <plot_geneset_enrichment.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
