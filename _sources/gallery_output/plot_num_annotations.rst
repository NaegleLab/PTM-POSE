
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery_output/plot_num_annotations.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_output_plot_num_annotations.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_output_plot_num_annotations.py:


Inspecting number of PTMs with annotation information available
===============================================================

As described in Running PTM-POSE section, PTM-POSE provides various options for annotating functional information for PTMs, coming from various databases. However, PTM functional information is inherently sparse, and so most annotations will only provide information on a handful of PTMs. For this reason, it can be useful to probe how many PTMsTo better understand the types of annotations that are available, as well as the number of PTMs that have an annotation of that type. This can be done using the `analyze` function in PTM-POSE.

Note: This examples assumes that you have already run the PTM-POSE pipeline and have at annotated PTMs with at least one layer of information.

.. GENERATED FROM PYTHON SOURCE LINES 9-24

.. code-block:: Python



    from ptm_pose import analyze
    from ptm_pose import plots as pose_plots
    import pandas as pd

    # Load spliced ptm and altered flank data
    spliced_ptms = pd.read_csv('spliced_ptms.csv')
    altered_flanks = pd.read_csv('altered_flanks.csv')

    pose_plots.show_available_annotations(spliced_ptms)







.. image-sg:: /gallery_output/images/sphx_glr_plot_num_annotations_001.png
   :alt: plot num annotations
   :srcset: /gallery_output/images/sphx_glr_plot_num_annotations_001.png
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 25-32

As you can, see there are only a few PTMs from each annotation that have 
available information, with the most being 9 PTMs out of the 184 differentially 
included sites having been associated with a biological process. While this this 
should be taken into consideration when analyzing these annotations, we can glean 
some useful information and identify potentially interesting proteins/sites to dig 
deeper into. Let's look at the PTMs that have been associated with a biological
process: 

.. GENERATED FROM PYTHON SOURCE LINES 32-36

.. code-block:: Python

    ptms_with_annotation, annotation_counts = analyze.get_ptm_annotations(spliced_ptms, database = "PhosphoSitePlus", annotation_type = 'Process')
    print('Specific PTMs with annotation:')
    ptms_with_annotation





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Specific PTMs with annotation:


.. raw:: html

    <div class="output_subarea output_html rendered_html output_result">
    <div>
    <style scoped>
        .dataframe tbody tr th:only-of-type {
            vertical-align: middle;
        }

        .dataframe tbody tr th {
            vertical-align: top;
        }

        .dataframe thead th {
            text-align: right;
        }
    </style>
    <table border="1" class="dataframe">
      <thead>
        <tr style="text-align: right;">
          <th></th>
          <th>Gene</th>
          <th>UniProtKB Accession</th>
          <th>Residue</th>
          <th>PTM Position in Canonical Isoform</th>
          <th>Modification Class</th>
          <th>PSP:ON_PROCESS</th>
          <th>dPSI</th>
          <th>Significance</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <th>0</th>
          <td>BCAR1</td>
          <td>P56945</td>
          <td>Y</td>
          <td>267.0</td>
          <td>Phosphorylation</td>
          <td>cell growth, induced</td>
          <td>-0.07</td>
          <td>0.0458775672499</td>
        </tr>
        <tr>
          <th>1</th>
          <td>BCAR1</td>
          <td>P56945</td>
          <td>Y</td>
          <td>287.0</td>
          <td>Phosphorylation</td>
          <td>cell growth, induced</td>
          <td>-0.07</td>
          <td>0.0458775672499</td>
        </tr>
        <tr>
          <th>2</th>
          <td>BIN1</td>
          <td>O00499</td>
          <td>T</td>
          <td>348.0</td>
          <td>Phosphorylation</td>
          <td>signaling pathway regulation</td>
          <td>-0.112</td>
          <td>0.0233903490744</td>
        </tr>
        <tr>
          <th>3</th>
          <td>CEACAM1</td>
          <td>P13688</td>
          <td>S</td>
          <td>461.0</td>
          <td>Phosphorylation</td>
          <td>apoptosis, altered</td>
          <td>0.525</td>
          <td>1.73943268451e-09</td>
        </tr>
        <tr>
          <th>4</th>
          <td>CTTN</td>
          <td>Q14247</td>
          <td>K</td>
          <td>272.0</td>
          <td>Acetylation</td>
          <td>cell motility, inhibited</td>
          <td>0.09</td>
          <td>0.0355211287599</td>
        </tr>
        <tr>
          <th>5</th>
          <td>CTTN</td>
          <td>Q14247</td>
          <td>S</td>
          <td>298.0</td>
          <td>Phosphorylation</td>
          <td>cell motility, altered; cytoskeletal reorganiz...</td>
          <td>0.09</td>
          <td>0.0355211287599</td>
        </tr>
        <tr>
          <th>6</th>
          <td>SPHK2</td>
          <td>Q9NRA0</td>
          <td>S</td>
          <td>387.0</td>
          <td>Phosphorylation</td>
          <td>cell motility, altered</td>
          <td>0.253</td>
          <td>0.0129400018182</td>
        </tr>
        <tr>
          <th>7</th>
          <td>SPHK2</td>
          <td>Q9NRA0</td>
          <td>T</td>
          <td>614.0</td>
          <td>Phosphorylation</td>
          <td>cell motility, altered</td>
          <td>0.253</td>
          <td>0.0129400018182</td>
        </tr>
        <tr>
          <th>8</th>
          <td>TSC2</td>
          <td>P49815</td>
          <td>S</td>
          <td>981.0</td>
          <td>Phosphorylation</td>
          <td>carcinogenesis, inhibited; cell growth, inhibi...</td>
          <td>-0.219</td>
          <td>4.18472157275e-05</td>
        </tr>
        <tr>
          <th>9</th>
          <td>YAP1</td>
          <td>P46937</td>
          <td>K</td>
          <td>342.0</td>
          <td>Ubiquitination</td>
          <td>carcinogenesis, altered</td>
          <td>-0.161;-0.188</td>
          <td>0.000211254197372;4.17884655686e-07</td>
        </tr>
      </tbody>
    </table>
    </div>
    </div>
    <br />
    <br />

.. GENERATED FROM PYTHON SOURCE LINES 37-38

We can also look at the number of PTMs associated with each annotation:

.. GENERATED FROM PYTHON SOURCE LINES 38-42

.. code-block:: Python

    print('Number of PTMs associated with each annotation:')
    annotation_counts






.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Number of PTMs associated with each annotation:

    PSP:ON_PROCESS
    cell motility, altered          3
    signaling pathway regulation    2
    cell growth, induced            2
    apoptosis, altered              1
    cell motility, inhibited        1
    cytoskeletal reorganization     1
    cell adhesion, inhibited        1
    carcinogenesis, inhibited       1
    cell growth, inhibited          1
    autophagy, inhibited            1
    carcinogenesis, altered         1
    Name: count, dtype: int64




.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.159 seconds)


.. _sphx_glr_download_gallery_output_plot_num_annotations.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_num_annotations.ipynb <plot_num_annotations.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_num_annotations.py <plot_num_annotations.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_num_annotations.zip <plot_num_annotations.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
